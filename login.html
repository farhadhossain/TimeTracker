<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Login</title>
    <script>
       var $ = require('jquery');
       window.$ = $;
       jQuery= $;
       require('bootstrap');
    </script>
    <link rel="stylesheet" href="./node_modules/bootstrap/dist/css/bootstrap.min.css">
    <style type="text/css">
    </style>
  </head>
  <body>
        <img src="./assets/images/WorkGuppyLogo.png" style="margin-left:25%;width:50%;margin-top:10%;padding-left:20px;" />
        <form id="loginForm" class="well" style="width:50%;">
          <div class="form-group">
              <label for="inputEmail">Email</label>
              <input type="email" class="form-control" name="email_id" placeholder="Email">
          </div>
          <div class="form-group">
              <label for="inputPassword">Password</label>
              <input type="password" class="form-control" name="password" placeholder="Password">
          </div>
          <div class="checkbox">
              <label><input type="checkbox"> Remember me</label>
          </div>
          <button id="target"  type="submit" class="btn btn-large btn-info btn-edit-trigger" style="width:100%;">Sign In</button>
      </form>
   
     <div class="modal fade" id="myPleaseWait" tabindex="-1" role="dialog" aria-hidden="true" data-backdrop="static">
        <div class="modal-dialog modal-sm" style="margin-top: 25%;width:50%;margin-left:25%;">
            <div class="modal-content">
                <div class="modal-header">
                    <span class="glyphicon glyphicon-time"></span>  Please Wait
                </div>
                <div class="modal-body">
                    <div class="progress">
                        <div class="progress-bar progress-bar-info progress-bar-striped active" style="width: 100%"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

  </body>
  <script>

      // Attach a submit handler to the form
    $( "#loginForm" ).submit(function( event ) {
      $('#myPleaseWait').modal('show');
      // Stop form from submitting normally
      event.preventDefault();
     
      // Get some values from elements on the page:
      var $form = $( this ),
          email_id = $form.find( "input[name='email_id']" ).val(),
          password = $form.find( "input[name='password']" ).val(),
          url=' http://ec2-54-218-59-115.us-west-2.compute.amazonaws.com/api';
     
      // Send the data using post
      var posting = $.post( url, { action:"check_login", email_id: email_id,  password: password} );
     
      // Put the results in a div
      posting.done(function( data ) {
         $('#myPleaseWait').modal('hide');
         console.log(data);
         const {ipcRenderer} = require('electron');
         ipcRenderer.send('asynchronous-message', 'loadURL', 'index.html');
         ipcRenderer.send('asynchronous-message', 'setSize', 400, 600);
        //var content = $( data ).find( "#content" );
        //$( "#result" ).empty().append( content );
      });

      posting.fail(function() {
         $('#myPleaseWait').modal('hide');
         alert("Couldn't connect to server");
       });

    });

    /*$("#target").click(function( event ) {
       const {ipcRenderer} = require('electron');
       ipcRenderer.send('asynchronous-message', 'loadURL', 'index.html');
       ipcRenderer.send('asynchronous-message', 'setSize', 400, 600);
    });*/

    $.fn.center = function () {
       this.css("position","absolute");
       this.css("top", ( $(window).height() - this.height()-40 ) / 2  + "px");
       this.css("left", ( $(window).width() - this.width() ) / 2 + "px");
       return this;
    }

    $('#loginForm').center();

  </script>
</html>
